# Enumeración 

Tags: #SCADA #OT #ConPot #Nmap #PLCScan #s7Enumerate 

* [ICS/SCADA-Tools](https://github.com/Spartan-Cybersecurity/CPICS-Tools)

## PLCScan 

```bash 
❯ https://github.com/meeas/plcscan       # Clonar la herramienta 
```

```bash 
❯ python2 plcscan.py IP                  # Revisar la MAC del dispositivo y enumerar los diferentes puertos como: modbus '502', S7Comm '102'
```

## Escaneo básico sugerido 'Nmap'

```bash 
❯ nmap -Pn -sT --scan-delay 1s --max-parallelism 1 -p 80,102,443,502,530,593,789,1089,1091,1911,1962,2222,2404,4000,4840,4843,4911,9600,19999,20000,20547,34962,34964,34980,44818,46823,46824,55000-55003 <Target>

❯ nmap -Pn -sT --scan-delay 1s -p 80,102,443,502,530,593,789,1089,1091,1911,1962,2222,2404,4000,4840,4843,4911,9600,19999,20000,20547,34962,34964,34980,44818,46823,46824,55000-55003 <Target>

Nota:
	1. Si nse utiliza la bandera -T, máximo que sea -T1
```

## Escaneos específicos de dispositivos 'Nmap'

#### Sielco Sistemi Winlog 

```bash 
❯ nmap -Pn -sT -p46824 <Target>   

Notas:
	1. El software Winlog de Sielco Sistemi, que escucha en el puerto 46824, es conocido por tener vulnerabilidades explotables como `winlog_runtime_2` en Metasploit
```

### Siemens SIMATIC S7 PLCs

```bash 
❯ nmap -Pn -sT -p102 --script s7-info <Target>

Notas:
	1. Estos PLCs de la familia S7 300/400 utilizan el protocolo S7comm para la programación de PLCs, el intercambio de datos y diagnósticos. Generalmente escuchan en el puerto 102
```

### Dispositivos Modbus

```bash 
❯ nmap -Pn -sT -p502 --script modbus-discover <Target>
❯ nmap -sT -Pn -p502 --script modbus-discover --script-args modbus-discover.aggressive=true <target> # Para una exploración más detallada, incluyendo la enumeración de todos los ID de esclavos con un enfoque más agresivo

Notas:
	1. Modbus TCP/IP es el protocolo de comunicación más común en dispositivos SCADA
```

## S7-Enumerate 

```bash 
❯ nmap -Pn -sT -p502 --script ./s7-enumerate.nse <Target>
❯ nmap -p102 --script ./s7-enumerate.nse <Target>
```