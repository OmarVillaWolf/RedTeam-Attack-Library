# Escaneo con Metasploit 

Tags: #Metasploit #WMap #Escaneo #EscaneoWEB

El escaneo y detección de vulnerabilidades, es el proceso de escanear vulnerabilidades en un target y verificar si pueden ser explotadas.  

## Escaneo de vulnerabilidades con MSF

```bash 
# Dentro de MSF, colocamos el sig comando

❯ db_nmap -sS -sV -O <IP>                   # Hacemos un escaneo a una IP con MSF 
	❯ hosts                                # Podemos ver el host, target IP, MAC, SO
	❯ services                             # Podemos ver la info del puerto, protocolo, nombre, estado e info
```

Podemos utilizar el sig. plugin de Metasploit. 

* [Metasploit-Autopwn](https://github.com/hahwul/metasploit-autopwn)

```bash 
❯ wget https://raw.githubusercontent.com/hahwul/metasploit-autopwn/master/db_autopwn.rb   # Descargamos el pluggin
❯ mv db_autopwn.rb /usr/share/metasploit-framework/plugins                                # Lo movemos al dir 'Plugins' de MSF

# Dentro de 'msfconsole'
❯ load db_autopwn                              # Cargamos el plugin 
❯ db_autopwn -p -t -PI <Port_Number>           # Usar el 'Autopwn'
	# p = Seleccionar modulos basados en los puertos abiertos 
	# t = Mostrar todos los modulos de exploit que hacen 'match' 
	# PI = Rango solo de exploits con esos puertos abiertos 
```

```bash 
❯ analyze                                      # Analiza el contenido de la DB de MSF 
❯ vulns                                        # Miramos los CVE y algunas referencias de las vulnerabilidades 
```

## Escaneo de vulnerabilidades WEB con WMap

* WMap: Es un escáner de vulnerabilidades de aplicaciones WEB que puede ser usada para automatizar enumeraciones de servidores web y escanear vulnerabilidades de aplicaciones web. Esta disponible como 'plugin' de MSF y puede ser cargado directamente a el. 

```bash 
❯ load wmap                               # Cargamos el modulo WMap
❯ wmap_sites -a <IP>                      # Agregamos un sitio (vhost, url) 
❯ wmap_sites -l                           # Listamos el sitio creado 

❯ wmap_targets -t http://<IP>             # Definimos un sitio 'target' 
❯ wmap_targets -l                         # Listamos el sitio creado anteriormente 

❯ wmap_run -t                             # Mostramos todos los modulos activos 
❯ wmap_run -e                             # Lanzamos los modulos encontra de todos los 'targets'

❯ wmap_vulns -l                           # Despliega la tabla de vulnerabilidades 
```

```bash  
# Nos muestra los metodos permitidos 
❯ msfconsole -q                  # q = Quitar el banner de inicio

	❯ use auxiliary/scanner/http/options          # Usamos el auxiliar 
	❯ options
	❯ set RHOSTS 192.168.1.194                    # Colocamos la IP de la maquina victima
	❯ run 
```

```bash  
# Nos  
❯ msfconsole -q                  # q = Quitar el banner de inicio

	❯ use auxiliary/scanner/http/http_put          # Usamos el auxiliar 
	❯ options
	❯ set RHOSTS 192.168.1.194                     # Colocamos la IP de la maquina victima
	❯ set PATH /data/ 
	❯ run 
```